\documentclass[onecolumn, draftclsnofoot, 10pt, compsoc]{../ThirdParty/IEEEtran}
\usepackage{graphicx}
\usepackage{url}
\usepackage{setspace}

\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{alltt}
\usepackage{color}
\usepackage{enumitem}
\usepackage{textcomp}
\usepackage{cite}

\usepackage[T1]{fontenc}
%\usepackage[utf8]{inputenc}
\usepackage{lmodern}
\usepackage[hidelinks]{hyperref}
\usepackage[normalem]{ulem}

\usepackage{geometry}

\geometry{textheight=9.5in, textwidth=7in}

\userpackage{minted}

\parindent = 0.0 in
\parskip = 0.1 in

%pull in the necessary preamble matter for pygments output
\input{../ThirdParty/pygments.tex}

\begin{document}
\begin{titlepage}
\pagenumbering{gobble}
\begin{singlespace}
\centering
\scshape{
    \huge{Writeup 2}\par
    \vspace{.5in}
    \large{CS 444}\par
    \large{October 28, 2018}\par
    \vspace{.5in}
    \large{Anton Synytsia, Eytan Brodsky, David Jansen}\par
    \vspace{.5in}
    \vfill
}
%\begin{abstract}
%\end{abstract}
\end{singlespace}
\end{titlepage}
\newpage
\pagenumbering{arabic}
\tableofcontents
\clearpage

\section{C-Look Elevator Scheduler}
C-Look elevator reads/writes from the lowest request address to the highest request address without moving back or forth, at any time in between, except for after dispatching the highest requested address, where the elevator resets to the next, lowest, requested address \cite{clook}. This allows for the disk head to read/write efficiently, in an expected direction; otherwise, changing directions too much will have performance implications and can physically deteriorate the hard-drive.

In order to implement C-Look, we had to start with an existing scheduler as a template template:
\begin{minted}[mathescape, linenos, numbersep=5pt, gobble=2, frame=lines, framesep=2mm]{bash}
cd /scratch/fall2018/group1/linux-yocto-3.19/block/
cp noop-iosched.c clook-iosched.c
\end{minted}

We then renamed all functions and identifiers C-Look, and modified two functions:
\begin{description}

\item[Request Adder]
Instead of appending to the end, like NO-OP did, we insert at a sorted location within the doubly-linked list of requests. Added requests are stored and sorted to the right of head:

\texttt{HEAD} \xrightarrow{} $1$ \xrightarrow{} $2$ \xrightarrow{} $7$ \xrightarrow{} $33$ \xrightarrow{} $34$ \xrightarrow{} \ldots

Our sort criteria is \href{https://elixir.bootlin.com/linux/v3.19/source/include/linux/blkdev.h#L873}{blk\_rq\_pos}.

In order to insert at the right location, we do the following:
\begin{enumerate}
\item Start at \textttt{HEAD} and traverse forward until:
\begin{itemize}
\item Next points to \textttt{HEAD}, meaning at last request node.
\item Next points to a request node, whose block position is greater than the block position of the request node being added.
\end{itemize}
\item Append request node to currently, iterated node, via \href{https://elixir.bootlin.com/linux/v3.19/source/include/linux/list.h#L61}{list\_add}.
\end{enumerate}

\inputminted{minted}[mathescape, linenos, numbersep=5pt, gobble=2, frame=lines, framesep=2mm]{c}{code_sample1.txt}

\item[Request Dispatcher]
Our modified version of the dispatcher prints out a note in case the request access order is inconsistent, that is if next request is less than previous:
\inputminted{minted}[mathescape, linenos, numbersep=5pt, gobble=2, frame=lines, framesep=2mm]{c}{code_sample2.txt}
This consistency verification also required a global variable, which we defined at the top:
\inputminted{minted}[mathescape, linenos, numbersep=5pt, gobble=2, frame=lines, framesep=2mm]{c}{code_sample3.txt}

\end{description}

The following is a section of code for
\section{Compiling Qemu with C-Look}
\subsection{Setup}
In order to compile Qemu with our scheduler, we had to edit two files within \texttt{/scratch/fall2018/group1/linux-yocto-3.19/block/}:
\begin{description}
\item[Makefile]
Within the Makefile, we had to add another configuration:
\inputminted{minted}[mathescape, linenos, numbersep=5pt, gobble=2, frame=lines, framesep=2mm]{bash}{code_sample4.txt}
\item[Kconfig.iosched]
Within this file, we had to add the following:
\inputminted{minted}[mathescape, linenos, numbersep=5pt, gobble=2, frame=lines, framesep=2mm]{bash}{code_sample5.txt}
\end{description}

\subsection{Compiling}
To recompile the scheduler, we ran the following commands:
\inputminted{minted}[mathescape, linenos, numbersep=5pt, gobble=2, frame=lines, framesep=2mm]{bash}{code_sample6.txt}

\Section{Starting Qemu}
In order to ease the process of running qemu, as well as, not having to run it in debug environment, we created a \texttt{qemu-run.sh} with custom commands:
\inputminted{minted}[mathescape, linenos, numbersep=5pt, gobble=2, frame=lines, framesep=2mm]{bash}{../qemu-run.sh}

To run, execute the following commands:
\inputminted{minted}[mathescape, linenos, numbersep=5pt, gobble=2, frame=lines, framesep=2mm]{bash}{code_sample7.txt}

\section{Testing}

\section{Concurrency 2}

\section{Version Control Log}
%% This file was generated by the script latex-git-log
\begin{tabular}{lp{12cm}}
  \label{tabular:legend:git-log}
  \textbf{acronym} & \textbf{meaning} \\
  V & \texttt{version} \\
  tag & \texttt{git tag} \\
  MF & Number of \texttt{modified files}. \\
  AL & Number of \texttt{added lines}. \\
  DL & Number of \texttt{deleted lines}. \\
\end{tabular}

\bigskip

%\iflanguage{ngerman}{\shorthandoff{"}}{}
\begin{longtable}{|rllp{8.5cm}rrr|}
\hline \multicolumn{1}{|c}{\textbf{V}} & \multicolumn{1}{c}{\textbf{tag}}
& \multicolumn{1}{c}{\textbf{date}}
& \multicolumn{1}{c}{\textbf{commit message}} & \multicolumn{1}{c}{\textbf{MF}}
& \multicolumn{1}{c}{\textbf{AL}} & \multicolumn{1}{c|}{\textbf{DL}} \\ \hline
\endhead

\hline \multicolumn{7}{|r|}{\longtableendfoot} \\ \hline
\endfoot

\hline% \hline
\endlastfoot

\hline 1 &  & 2018-10-08 & Initial commit & 1 & 1 & 0 \\
\hline 2 &  & 2018-10-08 & Create .gitignore & 1 & 6 & 0 \\
\hline 3 &  & 2018-10-08 & Update state & 1 & 0 & 1 \\
\hline 4 &  & 2018-10-08 & Setup readme & 1 & 5 & 0 \\
\hline 5 &  & 2018-10-08 & Update README.md & 1 & 2 & 0 \\
\hline 6 &  & 2018-10-08 & Uploaded concurrency & 2 & 225 & 0 \\
\hline 7 &  & 2018-10-08 & changed permissions & 4 & 0 & 0 \\
\hline 8 &  & 2018-10-09 & Setup writeup TeX & 2 & 126 & 0 \\
\hline 9 &  & 2018-10-09 & Added pygments & 1 & 98 & 0 \\
\hline 10 &  & 2018-10-09 & included pygements to preamble & 1 & 8 & 6 \\
\hline 11 &  & 2018-10-09 & First sucessful compile of writeup1 & 6 & 2008 & 2 \\
\hline 12 &  & 2018-10-09 & Updated gitignore & 5 & 3 & 2005 \\
\hline 13 &  & 2018-10-09 & Setup Writeup & 1 & 10 & 20 \\
\hline 14 &  & 2018-10-09 & Added git attributes to enforce EOL & 1 & 7 & 0 \\
\hline 15 &  & 2018-10-09 & EOL deal & 2 & 1 & 2 \\
\hline 16 &  & 2018-10-09 & Trying to fix TEX compiling & 2 & 79 & 1 \\
\hline 17 &  & 2018-10-09 & Added sections to writeup & 3 & 8 & 81 \\
\hline 18 &  & 2018-10-09 & Added the writeup for Command Logs and for the Qemu flags & 11 & 97 & 10 \\
\hline 19 &  & 2018-10-10 & Work on concurrency writeup & 8 & 30 & 56 \\
\hline 20 &  & 2018-10-10 & More work on Concurrency writeup & 2 & 12 & 7 \\
\hline 21 &  & 2018-10-10 & Made Concurrency use circular queue & 1 & 41 & 34 \\
\hline 22 &  & 2018-10-10 & Fixed concurrency print type & 1 & 9 & 6 \\
\hline 23 &  & 2018-10-10 & Renamed Assignment1 folder to Concurency and finished my writeup & 7 & 251 & 244 \\
\hline 24 &  & 2018-10-11 & Disabled BIB command in makefile & 2 & 3 & 3 \\
\hline 25 &  & 2018-10-11 & Added compile instructions & 1 & 26 & 3 \\
\hline 26 &  & 2018-10-11 & README adjustments & 1 & 3 & 3 \\
\hline 27 &  & 2018-10-13 & corrected name & 1 & 1 & 1 \\
\hline 28 &  & 2018-10-13 & explain -localtime and -append root=/dev/vda rw console=ttyS0 debug & 1 & 2 & 2 \\
\hline 29 &  & 2018-10-13 & add work log. & 1 & 6 & 0 \\
\hline 30 &  & 2018-10-13 & Added the version control table & 1 & 31 & 1 \\
\hline 31 &  & 2018-10-13 & Changed up how the lists were made & 1 & 48 & 31 \\
\hline 32 &  & 2018-10-15 & Refactored rdrand to use X86 intrinsic and created a general rand function & 1 & 88 & 69 \\
\hline 33 &  & 2018-10-15 & Updated concurrency writeup to reflect the refactored code. & 1 & 7 & 10 \\
\hline 34 &  & 2018-10-15 & Updated work log & 5 & 477 & 77 \\
\hline 35 &  & 2018-10-15 & Removed thirdparty & 1 & 0 & 362 \\
\hline 36 &  & 2018-10-22 & Added concurrency2 & 2 & 219 & 0 \\
\hline 37 &  & 2018-10-23 & Setup writeup2 and update comments in concurrency & 5 & 233 & 4 \\
\hline 38 &  & 2018-10-27 & Unignored Linux Yocto with our sched & 7 & 2 & 1 \\
\hline 39 &  & 2018-10-27 & Unignoring yocto & 1 & 0 & 2 \\
\hline 40 &  & 2018-10-27 & yocto... & 1 & 1 & 0 \\
\hline 41 &  & 2018-10-27 & Added clook scheduler & 4 & 582 & 2 \\
\hline 42 &  & 2018-10-27 & Setup Writeup2 & 11 & 9310 & 501 \\
\hline 43 &  & 2018-10-27 & Updated makefiles & 3 & 8 & 9 \\
\hline 44 &  & 2018-10-27 & Making refs work & 1 & 1 & 1 \\
\hline 45 &  & 2018-10-27 & Added Eyton's scheduler tester & 2 & 16 & 0 \\
\hline 46 &  & 2018-10-27 & Added David's makefile & 2 & 27 & 1 \\
\hline 47 &  & 2018-10-28 & Fixed compile errors in CLOOK and modifed Kconfig for inclusion & 4 & 84 & 6 \\
\hline 48 &  & 2018-10-28 & Added command for starting VM & 1 & 5 & 0 \\
\hline 49 &  & 2018-10-29 & Made clook print if unexpected access order & 2 & 8 & 0 \\
\hline 50 &  & 2018-10-29 & Clook Scheduler Writeup & 11 & 165 & 8 \\
\hline 51 &  & 2018-10-29 & Fixes to README & 1 & 7 & 7 \\
\end{longtable}


\clearpage
\medskip
\bibliographystyle{../ThirdParty/IEEEtran}
\bibliography{ref}

\end{document}
